import{ApplicationCommandOptionType as u}from"../../slash/ApplicationCommand.js";import j from"../../../_snowpack/pkg/antd/es/button.js";import p from"../../../_snowpack/pkg/antd/es/space.js";import m from"../../../_snowpack/pkg/antd/es/row.js";import d from"../../../_snowpack/pkg/antd/es/col.js";import T from"../../../_snowpack/pkg/antd/es/card.js";import B from"../../../_snowpack/pkg/antd/es/switch.js";import D from"../../../_snowpack/pkg/antd/es/typography.js";import e,{useEffect as k,useState as h}from"../../../_snowpack/pkg/react.js";import{commandState as F,optionElementState as S}from"../../recoil/index.js";import w from"./GenericInput.js";import L from"../../icons/index.js";import{useRecoilState as C}from"../../../_snowpack/pkg/recoil.js";import N from"./Choice.js";function H({type:a,index:_,inSubCommand:s,offset:x,deleter:E,updater:g}){const[o,c]=h({key:`${u[a]}Option-${_}`,type:a,name:"",description:"",required:!1}),[r,y]=C(F);k(()=>{s&&g&&g(o),!s&&r.options&&y({...r,options:[...r.options.filter(t=>t.key!==o.key),o]})},[o]);const[f,$]=h(!1);k(()=>{c({...o,required:f})},[f]);const[R,q]=C(S);function z(){s&&E&&E(o.key??""),!s&&r.options&&(y({...r,options:r.options.filter(t=>t.key!==o.key)}),q(R.filter(t=>t.key!==o.key)))}const[l,O]=h([]);k(()=>{console.log("useEffect:choiceOptionElements",l)},[l]);function A(t){console.log(`delete on ${t}`),O(n=>n.filter(i=>i.props.index!==t)),c(n=>({...n,choices:n.choices.filter(i=>i.key!==`ChoiceOption-${t}`)}))}function G(t){t.name&&c(n=>(console.log("updateChoiceOption:setOption",n),{...n,choices:[...(n.choices??[]).filter(i=>i.key!==t.key),t]}))}function I(t){const n=Date.now(),i={key:`ChoiceOption-${n}`,name:"",value:0};c({...o,choices:[...o.choices??[],i]}),O([...l,e.createElement(N,{key:`ChoiceOption-${n}`,index:n,inGroup:!0,deleter:A,updater:G,className:"choiceChild"})])}return e.createElement(e.Fragment,null,e.createElement(T,{title:e.createElement(e.Fragment,null,e.createElement(m,{gutter:16,align:"middle",justify:"start"},e.createElement(d,null,L[u[a]]),e.createElement(d,null,u[a]))),bordered:!1,style:s?{marginLeft:x||"20px"}:{}},e.createElement(p,{direction:"vertical",style:{width:"100%"}},e.createElement(w,{name:"name",setter:[o,c]}),e.createElement(w,{name:"description",setter:[o,c]}),e.createElement(m,null,e.createElement(d,{span:6},e.createElement(D.Title,{level:5},"Required?"),e.createElement(B,{checked:f,onChange:t=>$(t)})),e.createElement(d,{flex:"auto"},e.createElement(m,{align:"middle",justify:"end"},e.createElement(p,{align:"center"},e.createElement(j,{danger:!0,type:"primary",size:"large",onClick:z},"Delete"))))),e.createElement(m,{align:"middle",justify:"start"},e.createElement(p,{align:"center"},e.createElement(j,{type:"primary",size:"large",onClick:I},"Add Choice"))))),e.createElement(p,{direction:"horizontal",style:{width:"100%",paddingBottom:"10px"}},l))}export default H;
