import{ApplicationCommandOptionType as r}from"../../slash/ApplicationCommand.js";import j from"../../../_snowpack/pkg/antd/es/button.js";import d from"../../../_snowpack/pkg/antd/es/space.js";import p from"../../../_snowpack/pkg/antd/es/row.js";import m from"../../../_snowpack/pkg/antd/es/col.js";import z from"../../../_snowpack/pkg/antd/es/card.js";import t,{useEffect as A,useState as C}from"../../../_snowpack/pkg/react.js";import{commandState as B,optionElementState as D}from"../../recoil/index.js";import O from"./GenericInput.js";import w from"../../icons/index.js";import F from"./Option.js";import N from"../../helpers/keyofEnum.js";import{useRecoilState as h}from"../../../_snowpack/pkg/recoil.js";function L({type:c,index:x,inGroup:a,offset:S,deleter:f,updater:u}){const[n,l]=C({key:`${r[c]}Option-${x}`,type:c,name:"",description:"",options:[]}),[s,k]=h(B);A(()=>{console.log("useEffect [option] (SubCommand.tsx:30)",n),a&&u&&u({...n,options:n.options?.map(e=>({...e,key:void 0}))}),!a&&s.options&&k({...s,options:[...s.options.filter(e=>e.key!==n.key),{...n,options:n.options?.map(e=>({...e,key:void 0}))}]})},[n]);const[b,I]=h(D);function _(){a&&f&&f(n.key??""),!a&&s.options&&k({...s,options:s.options.filter(e=>e.key!==n.key)}),I(b.filter(e=>e.key!==n.key))}const[E,y]=C([]);function $(e){l(o=>({...o,options:[...(o.options??[]).filter(i=>i.key!==e.key),e]}))}function T(e){y(o=>o.filter(i=>i.key!==e)),l(o=>({...o,options:o.options?.filter(i=>i.key!==e)}))}function R(e){const o=Date.now(),i={key:`${r[parseInt(e.currentTarget.id)]}Option-${o}`,type:parseInt(e.currentTarget.id),name:"",description:"",options:[]};l({...n,options:[...n.options??[],i]}),y([...E,t.createElement(F,{key:`${r[parseInt(e.currentTarget.id)]}Option-${o}`,type:parseInt(e.currentTarget.id),index:o,inSubCommand:!0,offset:a?"40px":void 0,deleter:T,updater:$,className:"subCommandChild"})])}const g=N(r),q=g.splice(0,2);return t.createElement(t.Fragment,null,t.createElement(z,{title:t.createElement(t.Fragment,null,t.createElement(p,{gutter:16,align:"middle",justify:"start"},t.createElement(m,null,w[r[c]]),t.createElement(m,null,r[c]))),bordered:!1,style:a?{marginLeft:S||"20px"}:{}},t.createElement(d,{direction:"vertical",style:{width:"100%"}},t.createElement(O,{name:"name",setter:[n,l]}),t.createElement(O,{name:"description",setter:[n,l]}),t.createElement(p,null,t.createElement(m,{flex:"auto"},t.createElement(p,{align:"middle",justify:"start"},t.createElement(d,{align:"center"},g.map(e=>t.createElement(j,{key:e,id:r[e],onClick:R,size:"large",type:"primary"},t.createElement(p,{gutter:8,align:"middle",justify:"space-around"},t.createElement(m,null,w[e]),t.createElement(m,null,e))))))),t.createElement(m,{flex:"auto"},t.createElement(p,{align:"middle",justify:"end"},t.createElement(d,{align:"center"},t.createElement(j,{danger:!0,type:"primary",size:"large",onClick:_},"Delete"))))))),t.createElement(d,{direction:"vertical",style:{width:"100%",paddingBottom:"10px"}},E))}export default L;
