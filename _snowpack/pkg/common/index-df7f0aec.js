import{h as y,i as O,_ as R,m as u,l as z,y as C,t as k,p,s as N,k as _}from"./index-4e618a8b.js";import{r as o}from"./index-4b0af3e2.js";import{i as E}from"./ResizeObserver.es-beade628.js";var W="rc-observer-key",m=function(b){y(n,b);var g=O(n);function n(){var e;return R(this,n),e=g.apply(this,arguments),e.resizeObserver=null,e.childNode=null,e.currentElement=null,e.state={width:0,height:0,offsetHeight:0,offsetWidth:0},e.onResize=function(r){var t=e.props.onResize,i=r[0].target,a=i.getBoundingClientRect(),s=a.width,h=a.height,d=i.offsetWidth,l=i.offsetHeight,f=Math.floor(s),c=Math.floor(h);if(e.state.width!==f||e.state.height!==c||e.state.offsetWidth!==d||e.state.offsetHeight!==l){var v={width:f,height:c,offsetWidth:d,offsetHeight:l};e.setState(v),t&&Promise.resolve().then(function(){t(u(u({},v),{},{offsetWidth:d,offsetHeight:l}),i)})}},e.setChildNode=function(r){e.childNode=r},e}return z(n,[{key:"componentDidMount",value:function(){this.onComponentUpdated()}},{key:"componentDidUpdate",value:function(){this.onComponentUpdated()}},{key:"componentWillUnmount",value:function(){this.destroyObserver()}},{key:"onComponentUpdated",value:function(){var r=this.props.disabled;if(r){this.destroyObserver();return}var t=C(this.childNode||this),i=t!==this.currentElement;i&&(this.destroyObserver(),this.currentElement=t),!this.resizeObserver&&t&&(this.resizeObserver=new E(this.onResize),this.resizeObserver.observe(t))}},{key:"destroyObserver",value:function(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}},{key:"render",value:function(){var r=this.props.children,t=k(r);if(t.length>1)p(!1,"Find more than one child node with `children` in ResizeObserver. Will only observe first one.");else if(t.length===0)return p(!1,"`children` of ResizeObserver is empty. Nothing is in observe."),null;var i=t[0];if(o.isValidElement(i)&&N(i)){var a=i.ref;t[0]=o.cloneElement(i,{ref:_(a,this.setChildNode)})}return t.length===1?t[0]:t.map(function(s,h){return!o.isValidElement(s)||"key"in s&&s.key!==null?s:o.cloneElement(s,{key:"".concat(W,"-").concat(h)})})}}]),n}(o.Component);m.displayName="ResizeObserver";export{m as R};
