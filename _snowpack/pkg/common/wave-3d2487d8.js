import{h as b,i as k,_ as y,j as C,u as T,s as S,k as _,l as A,C as P,e as W}from"./index-4e618a8b.js";import{r as f}from"./index-4b0af3e2.js";import{w as p}from"./raf-6eea994e.js";import{c as I}from"./reactNode-7d14b139.js";var m;function h(c){return!c||c.offsetParent===null||c.hidden}function L(c){var i=(c||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return i&&i[1]&&i[2]&&i[3]?!(i[1]===i[2]&&i[2]===i[3]):!0}var g=function(c){b(s,c);var i=k(s);function s(){var e;return y(this,s),e=i.apply(this,arguments),e.containerRef=f.createRef(),e.animationStart=!1,e.destroyed=!1,e.onClick=function(t,r){var n,a;if(!(!t||h(t)||t.className.indexOf("-leave")>=0)){var o=e.props.insertExtraNode;e.extraNode=document.createElement("div");var E=C(e),l=E.extraNode,d=e.context.getPrefixCls;l.className="".concat(d(""),"-click-animating-node");var x=e.getAttributeName();if(t.setAttribute(x,"true"),r&&r!=="#ffffff"&&r!=="rgb(255, 255, 255)"&&L(r)&&!/rgba\((?:\d*, ){3}0\)/.test(r)&&r!=="transparent"){l.style.borderColor=r;var u=((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||t.ownerDocument,N=u instanceof Document?u.body:(a=u.firstChild)!==null&&a!==void 0?a:u;m=T(`
      [`.concat(d(""),"-click-animating-without-extra-node='true']::after, .").concat(d(""),`-click-animating-node {
        --antd-wave-shadow-color: `).concat(r,`;
      }`),"antd-wave",{csp:e.csp,attachTo:N})}o&&t.appendChild(l),["transition","animation"].forEach(function(v){t.addEventListener("".concat(v,"start"),e.onTransitionStart),t.addEventListener("".concat(v,"end"),e.onTransitionEnd)})}},e.onTransitionStart=function(t){if(!e.destroyed){var r=e.containerRef.current;!t||t.target!==r||e.animationStart||e.resetEffect(r)}},e.onTransitionEnd=function(t){!t||t.animationName!=="fadeEffect"||e.resetEffect(t.target)},e.bindAnimationEvent=function(t){if(!(!t||!t.getAttribute||t.getAttribute("disabled")||t.className.indexOf("disabled")>=0)){var r=function(a){if(!(a.target.tagName==="INPUT"||h(a.target))){e.resetEffect(t);var o=getComputedStyle(t).getPropertyValue("border-top-color")||getComputedStyle(t).getPropertyValue("border-color")||getComputedStyle(t).getPropertyValue("background-color");e.clickWaveTimeoutId=window.setTimeout(function(){return e.onClick(t,o)},0),p.cancel(e.animationStartId),e.animationStart=!0,e.animationStartId=p(function(){e.animationStart=!1},10)}};return t.addEventListener("click",r,!0),{cancel:function(){t.removeEventListener("click",r,!0)}}}},e.renderWave=function(t){var r=t.csp,n=e.props.children;if(e.csp=r,!f.isValidElement(n))return n;var a=e.containerRef;return S(n)&&(a=_(n.ref,e.containerRef)),I(n,{ref:a})},e}return A(s,[{key:"componentDidMount",value:function(){var t=this.containerRef.current;!t||t.nodeType!==1||(this.instance=this.bindAnimationEvent(t))}},{key:"componentWillUnmount",value:function(){this.instance&&this.instance.cancel(),this.clickWaveTimeoutId&&clearTimeout(this.clickWaveTimeoutId),this.destroyed=!0}},{key:"getAttributeName",value:function(){var t=this.context.getPrefixCls,r=this.props.insertExtraNode;return r?"".concat(t(""),"-click-animating"):"".concat(t(""),"-click-animating-without-extra-node")}},{key:"resetEffect",value:function(t){var r=this;if(!(!t||t===this.extraNode||!(t instanceof Element))){var n=this.props.insertExtraNode,a=this.getAttributeName();t.setAttribute(a,"false"),m&&(m.innerHTML=""),n&&this.extraNode&&t.contains(this.extraNode)&&t.removeChild(this.extraNode),["transition","animation"].forEach(function(o){t.removeEventListener("".concat(o,"start"),r.onTransitionStart),t.removeEventListener("".concat(o,"end"),r.onTransitionEnd)})}}},{key:"render",value:function(){return f.createElement(P,null,this.renderWave)}}]),s}(f.Component);g.contextType=W;export{g as W};
